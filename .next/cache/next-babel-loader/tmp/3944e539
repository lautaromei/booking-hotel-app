{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect } from 'react';\nimport Link from 'next/link';\nimport { MDBDataTable } from 'mdbreact';\nimport easyinvoice from 'easyinvoice';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport { clearErrors } from '../../redux/actions/bookingActions';\n\nconst MyBookings = () => {\n  const dispatch = useDispatch();\n  const {\n    bookings,\n    error\n  } = useSelector(state => state.bookings);\n  useEffect(() => {\n    if (error) {\n      toast.error(error);\n      dispatch(clearErrors());\n    }\n  }, [dispatch]);\n\n  const setBookings = () => {\n    const data = {\n      columns: [{\n        label: 'Booking ID',\n        field: 'id',\n        sort: 'asc'\n      }, {\n        label: 'Check In',\n        field: 'checkIn',\n        sort: 'asc'\n      }, {\n        label: 'Check Out',\n        field: 'checkOut',\n        sort: 'asc'\n      }, {\n        label: 'Amount Paid',\n        field: 'amount',\n        sort: 'asc'\n      }, {\n        label: 'Actions',\n        field: 'actions',\n        sort: 'asc'\n      }],\n      rows: []\n    };\n    bookings && bookings.forEach(booking => {\n      data.rows.push({\n        id: booking._id,\n        checkIn: new Date(booking.checkInDate).toLocaleString('en-US'),\n        checkOut: new Date(booking.checkOutDate).toLocaleString('en-US'),\n        amount: `$${booking.amountPaid}`,\n        actions: /*#__PURE__*/_jsxs(_Fragment, {\n          children: [/*#__PURE__*/_jsx(Link, {\n            href: `/bookings/${booking._id}`,\n            children: /*#__PURE__*/_jsx(\"a\", {\n              className: \"btn btn-primary\",\n              children: /*#__PURE__*/_jsx(\"i\", {\n                className: \"fa fa-eye\"\n              })\n            })\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: \"btn btn-success mx-2\",\n            onClick: () => downloadInvoice(booking),\n            children: /*#__PURE__*/_jsx(\"i\", {\n              className: \"fa fa-download\"\n            })\n          })]\n        })\n      });\n    });\n    return data;\n  };\n\n  const downloadInvoice = async booking => {\n    const data = {\n      \"documentTitle\": \"Booking INVOICE\",\n      //Defaults to INVOICE\n      \"currency\": \"USD\",\n      \"taxNotation\": \"vat\",\n      //or gst\n      \"marginTop\": 25,\n      \"marginRight\": 25,\n      \"marginLeft\": 25,\n      \"marginBottom\": 25,\n      \"logo\": \"https://res.cloudinary.com/bookit/image/upload/v1617904918/bookit/bookit_logo_cbgjzv.png\",\n      \"sender\": {\n        \"company\": \"Book IT\",\n        \"address\": \"13th Street. 47 W 13th St\",\n        \"zip\": \"10001\",\n        \"city\": \"New York\",\n        \"country\": \"United States\"\n      },\n      \"client\": {\n        \"company\": `${booking.user.name}`,\n        \"address\": `${booking.user.email}`,\n        \"zip\": \"\",\n        \"city\": `Check In: ${new Date(booking.checkInDate).toLocaleString('en-US')}`,\n        \"country\": `Check In: ${new Date(booking.checkOutDate).toLocaleString('en-US')}`\n      },\n      \"invoiceNumber\": `${booking._id}`,\n      \"invoiceDate\": `${new Date(Date.now()).toLocaleString('en-US')}`,\n      \"products\": [{\n        \"quantity\": `${booking.daysOfStay}`,\n        \"description\": `${booking.room.name}`,\n        \"tax\": 0,\n        \"price\": booking.room.pricePerNight\n      }],\n      \"bottomNotice\": \"This is auto generated Invoice of your booking on Book IT.\"\n    };\n    const result = await easyinvoice.createInvoice(data);\n    easyinvoice.download(`invoice_${booking._id}.pdf`, result.pdf);\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"container container-fluid\",\n    children: [/*#__PURE__*/_jsx(\"h1\", {\n      className: \"my-5\",\n      children: \"My Bookings\"\n    }), /*#__PURE__*/_jsx(MDBDataTable, {\n      data: setBookings(),\n      className: \"px-3\",\n      bordered: true,\n      striped: true,\n      hover: true\n    })]\n  });\n};\n\nexport default MyBookings;","map":null,"metadata":{},"sourceType":"module"}